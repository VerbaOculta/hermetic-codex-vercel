<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Codex Herm√©tico - Demo Whop</title>
  <style>
    body { background: #0d0d16; color: white; font-family: sans-serif; text-align: center; padding-top: 5rem; }
    #userInfo { background: #1a1a2e; padding: 2rem; border-radius: 12px; max-width: 500px; margin: auto; }
  </style>
</head>
<body>
  <h1>‚ú® Bienvenido al Codex Herm√©tico</h1>
  <div id="userInfo">Cargando experiencia...</div>

  <script>
    const path = window.location.pathname; // /experiences/exp_XXXXX
    const experienceId = path.split('/').pop();

    fetch('/api/experience', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ experienceId })
    })
    .then(res => res.json())
    .then(data => {
      const { user, id, status, customFields } = data;

      const userInfo = `
        <h2>üîç Datos de tu experiencia</h2>
        <p><strong>ID:</strong> ${id}</p>
        <p><strong>Status:</strong> ${status}</p>
        <p><strong>Usuario:</strong> ${user?.name || 'Sin nombre'} (${user?.email})</p>
        <h3>üß© Campos personalizados:</h3>
        <ul>
          ${(customFields || []).map(f => `<li><b>${f.key}</b>: ${f.value}</li>`).join('') || '<li>No hay campos.</li>'}
        </ul>
      `;

      document.getElementById('userInfo').innerHTML = userInfo;
    })
    .catch(err => {
      document.getElementById('userInfo').innerText = 'Error al cargar experiencia.';
      console.error(err);
    });
  </script>
</body>
</html>
