<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Revelaci√≥n Codex</title>
  <link
    href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Cinzel+Decorative:wght@700&display=swap"
    rel="stylesheet" />

  <style>
    /* === ESTILOS BASE === */
    html,
    body {
      margin: 0;
      padding: 0 2rem 2rem 2rem;
      /*background: linear-gradient(to bottom, #0D0D0D, #1A1A2E);*/
      background: linear-gradient(309deg, #0d0d0d 44%, #0e1a36 82%);
      background: linear-gradient(to bottom, #0a0a14, #0e0e1d);
      color: #fff;
      font-family: "Playfair Display", serif;
    }

    html,
    body {
      height: 100%;
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: optimizeLegibility;
    }

    *,
    *::before,
    *::after {
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: optimizeLegibility;
    }

    body.mystic-glow {
      animation: glowFade 1.5s ease-in-out;
    }

    @keyframes glowFade {
      0% {
        box-shadow: inset 0 0 100px rgba(255, 215, 0, 0.2);
        background-color: #1f1a2e;
      }

      50% {
        box-shadow: inset 0 0 200px rgba(255, 215, 0, 0.4);
        background-color: #292042;
      }

      100% {
        box-shadow: inset 0 0 100px rgba(255, 215, 0, 0.2);
        background-color: #1a1a2e;
      }
    }

    h2 {
      font-size: 1.5rem;
      color: #ffd700;
      margin: 2rem 0 1rem;
      text-align: center;
      font-family: "Cinzel Decorative", cursive;
    }

    @media (max-width: 600px) {
      h2 {
        font-size: 1rem;
        margin: 1rem 0 0rem;
      }
    }

    /* === CARRUSEL === */
    .carousel {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 12px;
    }

    .carousel-container {
      display: flex;
      flex-wrap: nowrap;
      gap: 1rem;
      padding: 1rem 0;
      scroll-snap-type: x mandatory;
      -webkit-overflow-scrolling: touch;
      justify-content: center;
      /* valor por defecto para pantallas grandes */
      overflow-x: auto;
      max-width: 100%;
      padding-left: 1rem;
      padding-right: 1rem;
    }

    @media (max-width: 600px) {
      .carousel-container {
        justify-content: flex-start;
      }
    }

    .carousel-container .card {
      flex: 0 0 auto;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      border-radius: 16px;
    }

    .carousel-container .card.selected {
      transform: scale(1.05);
      box-shadow: 0 0 20px 6px rgba(255, 215, 0, 0.5);
      /* resplandor visible */
      z-index: 1;
    }

    .card {
      flex: 0 0 auto;
      width: 80px;
      scroll-snap-align: center;
      cursor: pointer;
      position: relative;
      transition: transform 0.3s;
    }

    .card img {
      width: 100%;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(255, 255, 255, 0.1);
      transition: box-shadow 0.3s ease, transform 0.3s ease;
    }

    .card:hover img {
      box-shadow: 0 0 15px rgba(255, 215, 0, 0.7);
      transform: scale(1.05);
    }

    .card.selected img {
      box-shadow: 0 0 20px rgba(255, 215, 0, 1);
      transform: scale(1.1);
    }

    .card-title {
      position: absolute;
      bottom: 8px;
      left: 0;
      right: 0;
      text-align: center;
      font-size: 0.75rem;
      background: rgba(0, 0, 0, 0.6);
      padding: 4px;
      border-radius: 0 0 10px 10px;
      opacity: 0;
      transition: opacity 0.3s;
    }

    .card:hover .card-title {
      opacity: 1;
    }

    @media (max-width: 600px) {
      .card {
        width: 65px;
      }

      .card-title {
        font-size: 0.6rem;
      }

      .button-container {
        text-align: center;

        margin-bottom: 4rem !important;
      }
    }

    /* === BOT√ìN === */
    .button-container {
      display: flex;
      justify-content: center;
      align-items: center;
      margin-top: 2rem;
      width: 100%;
    }

    .btn-continue {
      display: none;
      background: radial-gradient(circle at center, #ffd700 0%, #b38600 100%);
      color: #1a1a2e;
      border: 1px solid #ffd700;
      padding: 10px 24px;
      font-size: 1rem;
      font-family: "Cinzel Decorative", cursive;
      letter-spacing: 1px;
      cursor: pointer;
      border-radius: 8px;
      box-shadow: 0 0 15px rgba(255, 215, 0, 0.4);
      transition: all 0.4s ease;
      text-transform: uppercase;
    }

    .btn-continue:hover {
      background: #ffd700;
      color: #000;
      box-shadow: 0 0 25px rgba(255, 215, 0, 0.7);
    }

    .btn-continue.active {
      display: inline-block;
    }

    /* === INTERPRETACI√ìN === */
    #interpretation {
      max-width: 710px;
      margin: 2rem auto;
      padding: 1.5rem 1.5rem;
      background: rgba(0, 0, 0, 0.4);
      font-style: italic;
      font-size: 1.1rem;
      color: #ffd700;
      white-space: pre-line;
      font-family: "Playfair Display", serif;
      border-left: none;

      align-items: center;
      /* Esto alinea horizontalmente */
      justify-content: center;
      text-align: center;
    }

    .card-interpretation-block {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 2rem;
      opacity: 0;
      transform: translateY(-40px);
      transition: all 0.8s ease;
    }

    .card-interpretation-block.visible {
      opacity: 1;
      transform: translateY(0);
    }

    .card-interpretation-block .static-card {
      width: 100px;
      flex-shrink: 0;
    }

    /* === NUEVO BLOQUE VERTICAL === */
    .card-interpretation-block.vertical {
      /*
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 1rem;
  margin: 3rem auto;
  max-width: 680px;
  padding: 1.5rem;
  border-radius: 16px;
  background: none;
  box-shadow: 0 0 20px rgba(255, 215, 0, 0.15);
  position: relative;
  z-index: 1;
  transition: all 0.8s ease;*/

      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1.2rem;
      margin: 2rem auto;
      padding: 1.2rem 1rem;
      width: 100%;
      max-width: 100%;
      box-sizing: border-box;
      border-radius: 16px;
      background: none;
      box-shadow: 0 0 20px rgba(255, 215, 0, 0.15);
    }

    .card-interpretation-block.vertical .static-card {
      width: 105px;
      max-width: 100%;
      border-radius: 12px;
      background: none;
      padding: 0;
      box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
      filter: drop-shadow(0 0 10px gold);
    }

    .card-interpretation-block.vertical .interpretation-text {
      background: rgba(255, 255, 255, 0.05);
      border-left: none;
      border-top: 2px solid gold;
      padding: 1.2rem 1.5rem;
      border-radius: 12px;
      color: #ffd700;
      font-family: "Playfair Display", serif;
      text-align: justify;
      max-width: 100%;
      background: rgba(0, 0, 0, 0.3);
    }

    .card-interpretation-block.vertical .interpretation-text h3 {
      font-family: "Cinzel Decorative", cursive;
      color: gold;
      text-align: center;
      text-transform: uppercase;
      font-size: 1.6rem;
      margin-bottom: 1.2rem;
      border-bottom: 1px solid rgba(255, 215, 0, 0.2);
      padding-bottom: 0.3rem;
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.7);
    }

    .card-interpretation-block.vertical .interpretation-text p {
      text-align: justify;
      line-height: 1.75;
    }

    @media (max-width: 600px) {
      .card-interpretation-block.vertical .interpretation-text p {
        text-align: left;
        line-height: 1.6;
      }
    }

    .card-interpretation-block.vertical .interpretation-text p:first-letter {
      font-size: 2.4rem;
      font-weight: bold;
      color: #ffd700;
      float: left;
      margin-right: 0.4rem;
      line-height: 1;
    }

    .card.static-card {
      background: none !important;
      box-shadow: none !important;
      padding: 0 !important;
      margin: 0 auto;
      display: flex;
      justify-content: center;
      border: none !important;
      margin-bottom: 1.5rem;
    }

    .card.static-card img {
      box-shadow: 0 0 15px rgba(255, 215, 0, 0.4);
      border-radius: 10px;
    }

    .card-interpretation-block.vertical:hover {
      box-shadow: 0 0 25px rgba(255, 215, 0, 0.3);
      transform: translateY(-2px);
    }

    /* === OTROS === */
    .symbol-loading {
      width: 80px;
      height: 80px;
      margin: 2rem auto;
      border: 4px solid rgba(255, 215, 0, 0.2);
      border-top: 4px solid gold;
      border-radius: 50%;
      animation: spin 1.2s linear infinite;
    }

    #selectedCardsView {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-top: 2rem;
    }

    #interpretacion-anchor {
      display: contents;
    }

    .hidden {
      display: none !important;
      height: 0 !important;
      margin: 0 !important;
      padding: 0 !important;
      overflow: hidden !important;
    }

    .hidden-space {
      height: 0 !important;
      opacity: 0 !important;
      overflow: hidden !important;
      margin: 0 !important;
      padding: 0 !important;
      pointer-events: none;
    }

    @keyframes glowPulse {
      0% {
        box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
      }

      50% {
        box-shadow: 0 0 40px rgba(255, 215, 0, 1);
      }

      100% {
        box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
      }
    }

    @keyframes fadeInOut {
      0% {
        opacity: 0;
      }

      20% {
        opacity: 1;
      }

      80% {
        opacity: 1;
      }

      100% {
        opacity: 0;
      }
    }

    .glow-temp img {
      animation: glowPulse 2s ease-in-out infinite;
    }

    .symbol {
      width: 80px;
      height: 80px;
      background: url("https://media.atomicatpages.net/u/VKdhbutUBLg5pZCmDWr4fJf466f1/Pictures/gdwgon2513836.png") no-repeat center;
      background-size: contain;
      filter: brightness(0) saturate(100%) invert(65%) sepia(79%) saturate(400%) hue-rotate(5deg) brightness(95%) contrast(90%);
      animation: spin 3s linear infinite;
      margin: 2rem auto;
    }

    @keyframes spin {
      from {
        transform: rotate(0deg);
      }

      to {
        transform: rotate(360deg);
      }
    }
  </style>
  <style>
    .quiz-container {
      max-width: 700px;
      margin: 1rem auto 1rem;
      padding: 1.2rem;
      background: rgba(0, 0, 0, 0.5);
      border-radius: 16px;
      color: #ffd700;
      font-family: "Playfair Display", serif;
      box-shadow: 0 0 20px rgba(255, 215, 0, 0.15);
      /* resplandor tenue */
      display: none;
      animation: fadeInUp 1s ease forwards;
      opacity: 0;
    }

    @keyframes fadeInUp {
      0% {
        opacity: 0;
        transform: translateY(30px);
      }

      100% {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .quiz-container h2 {
      display: block !important;
      font-family: "Cinzel Decorative", cursive;
      font-size: 1.5rem;
      text-align: center;
      margin-bottom: 1rem;
      color: gold;
      line-height: 1.6;
      text-shadow: 0 0 4px rgba(255, 215, 0, 0.25);
    }

    .quiz-options {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      margin: 1.2rem 0;
    }

    .quiz-option {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 215, 0, 0.2);
      padding: 1rem;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 1rem;
      outline: none;
    }

    .quiz-option:hover,
    .quiz-option.selected {
      border-color: gold;
      box-shadow: 0 0 15px rgba(255, 215, 0, 0.4);
      background: rgba(255, 255, 255, 0.08);
      transform: scale(1.02);
    }

    .quiz-option:focus {
      outline: 2px solid gold;
    }

    .quiz-continue {
      display: block;
      margin: 1.5rem auto 0;
      background: gold;
      color: black;
      font-family: "Cinzel Decorative", cursive;
      font-size: 1rem;
      padding: 0.8rem 2rem;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .quiz-continue:hover {
      background: #ffd700;
      box-shadow: 0 0 20px rgba(255, 215, 0, 0.6);
    }

    .revelation-section {
      display: none;
      text-align: center;
      margin-top: 3rem;
      padding: 2rem;
      background: rgba(0, 0, 0, 0.5);
      /* fondo transl√∫cido */
      border: 1px solid gold;
      border-radius: 16px;
      box-shadow: 0 0 25px rgba(255, 215, 0, 0.12);
      /* borde suave */
      animation: fadeIn 1.5s ease forwards;
      opacity: 0;
      max-width: 700px;
      margin-left: auto;
      margin-right: auto;
    }

    .revelation-section h3 {
      color: gold;
      font-family: "Cinzel Decorative", cursive;
      font-size: 1.5rem;
      margin-bottom: 1.5rem;
      text-shadow: 0 0 8px rgba(255, 215, 0, 0.5);
    }

    @keyframes fadeIn {
      0% {
        opacity: 0;
        transform: scale(0.98);
      }

      100% {
        opacity: 1;
        transform: scale(1);
      }
    }

    @keyframes pulse-glow {
      0% {
        box-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
      }

      50% {
        box-shadow: 0 0 30px rgba(255, 215, 0, 0.8);
      }

      100% {
        box-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
      }
    }

    .revelation-section.visible {
      display: block;
    }

    .form-section {
      display: none;
      margin-top: 2rem;
      text-align: center;
      color: white;
    }

    .form-section.visible {
      display: block;
    }
  </style>
  <style>
    .synthesis-box {
      background: linear-gradient(#0c0c0c, #141414);
      border: 2px solid gold;
      border-radius: 1rem;
      padding: 2rem;
      margin: 3rem auto;
      max-width: 680px;
      box-shadow: 0 0 25px rgba(255, 215, 0, 0.3);
      opacity: 0;
      transform: translateY(30px);
      transition: all 1s ease;
    }

    .synthesis-box.visible {
      opacity: 1;
      transform: translateY(0);
    }

    .synthesis-box p {
      color: #ffd700;
      font-weight: 400;
      font-size: 1.1rem;
      line-height: 1.9;
      text-align: justify;
      margin-bottom: 1.5rem;
    }

    .synthesis-title {
      text-align: center;
      color: #ffd700;
      font-size: 1.8rem;
      font-weight: bold;
      margin-bottom: 2rem;
      text-shadow: 0 0 8px rgba(255, 215, 0, 0.4);
    }

    .interpretation-final-body p {
      margin-bottom: 1.5rem;
    }

    .interpretation-final-body p:first-of-type::first-letter {
      float: left;
      font-size: 2.4rem;
      font-weight: bold;
      color: gold;
      margin-right: 0.4rem;
      line-height: 1;
    }

    .interpretation-final-wrapper {
      max-width: 700px;
      margin: 2rem auto 1.5rem;
      padding: 1.5rem;
      background: rgba(0, 0, 0, 0.5);
      /* Suavidad de fondo */
      border: 1px solid rgba(255, 215, 0, 0.3);
      /* Borde tenue */
      border-radius: 16px;
      color: #ffd700;
      font-family: "Playfair Display", serif;
      font-style: italic;
      font-size: 1.1rem;
      line-height: 1.7;
      text-align: justify;
      box-shadow: 0 0 25px rgba(255, 215, 0, 0.12);
      /* Resplandor leve */
      white-space: pre-line;
      animation: fadeInUp 1s ease forwards;
      opacity: 0;
    }

    @keyframes fadeInUp {
      0% {
        opacity: 0;
        transform: translateY(30px);
      }

      100% {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .interpretation-final-title {
      text-align: center;
      font-size: 2rem;
      font-weight: bold;
      font-style: italic;
      text-shadow: 0 0 6px gold;
      margin-bottom: 0.5rem;
    }

    .interpretation-divider {
      border: 0;
      height: 1px;
      background: gold;
      margin: 0 auto 1.2rem;
      width: 80%;
    }

    .interpretation-final-body {
      font-size: 1.2rem;

      font-style: italic;
      color: #ffd700;
      text-align: left;
      line-height: 1.9;
      /* o incluso 1.9 si lo deseas m√°s et√©reo */
    }

    .interpretation-final-body p:first-of-type::first-letter {
      float: left;
      font-size: 2.4rem;
      font-weight: bold;
      color: gold;
      margin-right: 0.4rem;
      line-height: 1;
    }

    .interpretation-final-body p {
      margin-bottom: 1.2rem;
      line-height: 1.8;
    }

    .hidden-space {
      height: 0 !important;
      opacity: 0 !important;
      overflow: hidden !important;
      margin: 0 !important;
      padding: 0 !important;
      pointer-events: none;
      display: none !important;
    }

    #interpretacion-anchor {
      width: 100%;
      display: block;
    }

    .interpretation-loading-text {
      text-align: center;
      font-style: italic;
      font-size: 1.3rem;
      color: #ffd700;
      margin-bottom: 2rem;
      line-height: 1.6;
      animation: fadeIn 1.5s ease forwards;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .magic-message {
      display: none;
      position: fixed;
      top: 40%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0, 0, 0, 0.85);
      padding: 1rem 2rem;
      border: 2px solid gold;
      border-radius: 10px;
      color: #ffd700;
      font-size: 1.2rem;
      font-family: "Playfair Display", serif;
      text-align: center;
      z-index: 9999;
      max-width: 90%;
      width: fit-content;
      animation: fadeInOut 3s ease forwards;
      box-shadow: 0 0 15px rgba(255, 215, 0, 0.3);
    }

    #finalSynthesisText .loading {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 2rem 1rem;
    }

    #revelation {
      background: linear-gradient(to bottom, #0a0a0a, #000);
      border: 1px solid rgba(255, 215, 0, 0.4);
      border-radius: 20px;
      box-shadow: 0 0 20px rgba(255, 215, 0, 0.15);
      padding: 2rem;
      max-width: 680px;
      margin: 2rem auto;
      color: #ffd700;
      font-family: "Playfair Display", serif;
      text-align: center;
    }

    .carousel-wrapper {
      background: transparent !important;
      box-shadow: none !important;
      max-width: 480px;
      margin: 0 auto;
      padding: 0 1rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }

    .codex-intro {
      /*background: linear-gradient(#0c0c0c, #141414);*/
      border-radius: 1rem;
      padding: 2rem;
      /*margin: 3rem auto;*/
      margin-top: 1.8rem;
      margin-bottom: 2.5rem;
      max-width: 680px;
      /*box-shadow: 0 0 20px rgba(255, 215, 0, 0.15);*/
      opacity: 0;
      transform: translateY(30px);
      transition: all 1s ease;
      text-align: center;
      border: none;
      /* Eliminamos cualquier borde heredado */
    }

    .codex-intro.visible {
      opacity: 1;
      transform: translateY(0);
    }

    .intro-title {
      font-family: "Cinzel Decorative", cursive;
      font-size: 1.8rem;
      font-weight: 700;
      letter-spacing: 0.5px;
      line-height: 1.6;
      margin-bottom: 1.5rem;
      color: #ffd700;
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.4);
      text-transform: uppercase;
    }

    .secondary-title {
      font-family: "Cinzel Decorative", cursive;
      font-size: 1.6rem;
      font-weight: 700;
      letter-spacing: 0.5px;
      line-height: 1.6;
      margin-bottom: 1.5rem;
      color: #ffd700;
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.7);
      text-transform: none;
    }

    .intro-description {
      color: #dadada;
      /*color: #FFD700;*/
      font-weight: 500;
      font-size: 1.3rem;
      line-height: 1.8;
      text-align: center;
      text-shadow: 0 0 6px rgba(255, 215, 0, 0.25);
      animation: fadeInText 2s ease-in-out forwards;
      opacity: 0;
    }

    .intro-description em {
      font-size: 1.8rem;
      display: inline-block;
      font-weight: bold;
      margin-top: 1rem;
      font-style: italic;
    }

    @keyframes fadeInText {
      from {
        opacity: 0;
        transform: translateY(10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .final-choice-card {
      width: 120px;
      height: auto;
      margin: 1rem;
      padding: 0.5rem;
      border: 2px solid gold;
      border-radius: 12px;
      box-shadow: 0 0 20px rgba(255, 215, 0, 0.4);
      background-color: #111;
      text-align: center;
      transition: transform 0.3s ease;
    }

    .final-choice-card img {
      width: 100%;
      height: auto;
      border-radius: 8px;
    }

    .final-choice-card:hover {
      transform: scale(1.08);
      cursor: pointer;
    }

    /* === CARTAS RESPONSIVAS: SIMPLES, UNA AL LADO DE LA OTRA EN TODOS LOS DISPOSITIVOS === */
    .revelation-cards {
      display: flex;
      justify-content: center;
      align-items: flex-start;
      flex-wrap: wrap;
      gap: 1.5rem;
      margin-top: 2rem;
      padding: 1rem;
    }

    .revelation-cards .card {
      width: 100px;
      max-width: 100px;
      flex: 0 0 auto;
      border: 2px solid gold;
      border-radius: 12px;
      padding: 0.5rem;
      box-shadow: 0 0 12px rgba(255, 215, 0, 0.3);
      background-color: #111;
      text-align: center;
      transition: transform 0.3s ease;
    }

    .revelation-cards .card img {
      width: 100%;
      height: auto;
      border-radius: 8px;
    }

    .revelation-cards .card .card-title {
      margin-top: 0.5rem;
      color: gold;
      font-weight: bold;
      font-size: 0.9rem;
    }

    .revelation-cards .card:hover {
      transform: scale(1.05);
      cursor: pointer;
    }

    .btn-continue {
      padding: 12px 24px;
      font-size: 18px;
      background: #333;
      color: #999;
      border: 2px solid #555;
      border-radius: 8px;
      cursor: not-allowed;
      opacity: 0.6;
      transition: all 0.4s ease;
    }

    .btn-continue.enabled {
      background: linear-gradient(to right, #a07cff, #c53c80);
      color: #fff;
      border-color: gold;
      cursor: pointer;
      opacity: 1;
      animation: pulseGold 1.6s infinite;
    }

    @keyframes pulseGold {
      0% {
        box-shadow: 0 0 8px gold;
      }

      50% {
        box-shadow: 0 0 16px #ffc107;
      }

      100% {
        box-shadow: 0 0 8px gold;
      }
    }

    .btn-alquimico {
      background: linear-gradient(90deg, #a472f7, #ff5ea5);
      /* m√≠stico, vibrante */
      border: 2px solid #ffd700;
      /* dorado */
      color: #fffaf0;
      font-family: "Cinzel Decorative", cursive;

      text-transform: uppercase;
      padding: 16px 28px;
      border-radius: 12px;
      box-shadow: 0 0 12px #ffd700cc, 0 0 25px #ff5ea577;
      transition: all 0.3s ease;
      cursor: pointer;
      letter-spacing: 1px;
      font-size: 1rem;
      /* m√°s peque√±o */
      padding: 10px 24px;
      /* menos alto */
    }

    .btn-alquimico:hover {
      transform: scale(1.04);
      box-shadow: 0 0 16px #fffbe6, 0 0 30px #ff66ccaa;
    }

    .final-subtitle {
      font-family: "Cinzel Decorative", cursive;
      font-size: 1.1rem;
      color: #f3e6d3;
      text-align: center;
      margin-top: 40px;
      margin-bottom: 25px;
      text-shadow: 0 0 5px rgba(255, 255, 255, 0.08);
    }

    @media (max-width: 480px) {
      .final-subtitle {
        font-size: 1rem;
      }
    }

    .card.selected .card-title {
      opacity: 1;
    }

    .final-hint {
      margin-top: 20px !important;
    }

    #vsl-section.codex-intro.visible {
      margin-bottom: 0px !important;
      padding-bottom: 0px !important;
    }

    .vsl-intro-copy {
      text-align: center;
      margin-bottom: 1.5rem;
      padding: 0 1rem;
      animation: fadeInUp 1s ease 0.5s forwards;
    }

    @keyframes fadeInUp {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .vsl-intro-copy p {
      font-family: "Playfair Display", serif;
      font-style: italic;
      font-size: 1.25rem;
      line-height: 1.6;
      color: #e0d8c8;
      text-shadow: 0 0 3px rgba(255, 255, 255, 0.1);
      opacity: 1;
      /* Asegura que sea visible */
      transform: translateY(0);
      /* Elimina el desplazamiento */
    }

    .copy-umbral {
      font-family: "Lora", sans-serif;
      font-size: 19px;
      line-height: 1.6;
      /* aumenta el aire entre l√≠neas */
      color: #eaeaea;
      text-align: center;

      font-weight: 250;
      margin-bottom: 2rem;
      padding: 0 1rem;
      text-shadow: none;
      filter: none;
    }

    .vsl-container {
      border: 2px solid rgba(255, 255, 255, 0.05);
      box-shadow: 0 0 25px rgba(147, 112, 219, 0.3);
      /* violeta sutil */
      border-radius: 12px;
      overflow: hidden;
      transition: box-shadow 0.3s ease;
    }

    .vsl-container:hover {
      box-shadow: 0 0 35px rgba(255, 215, 0, 0.4);
      /* glow dorado */
    }

    .btn-alquimico {
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .btn-alquimico:hover {
      transform: scale(1.03);
      box-shadow: 0 0 15px #ffd700, 0 0 25px #ff00cc;
      /* dorado y rosa vibrando */
    }

    .carousel-glow {
      /*background: radial-gradient(circle at center, rgba(255, 225, 150, 0.12), rgba(0, 0, 0, 0) 70%);*/
      /*box-shadow: 0 0 60px rgba(255, 220, 130, 0.15);*/
      border-radius: 24px;
      padding: 2rem 1rem;
      margin-top: 2rem;
      margin-bottom: 2rem;
      transition: all 0.4s ease-in-out;
    }

    .final-subtitle {
      text-transform: uppercase;
    }

    .final-hint.poetico {
      font-family: "Cormorant Garamond", serif;
      text-transform: none;
      font-size: 18px;
      line-height: 1.6;
    }

    .dorado {
      color: #ffd700;
      font-style: italic;
    }

    #confirmFinalSelection {
      margin-bottom: 3rem !important;
    }

    .headline {
      font-family: "Playfair Display", serif;
      font-size: 2.5rem;
      font-weight: bold;
      color: #ffd700;
      text-align: center;
      line-height: 1.3;
      margin: 2rem auto;
      max-width: 90%;
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.4);
      line-height: 1.4;
    }

    .headline .subrayado {
      font-style: italic;
      text-decoration: underline;
      text-underline-offset: 4px;
    }

    .headline {
      margin-top: 0 !important;
    }

    #vsl-section {
      margin-top: 0 !important;
      padding-top: 0 !important;

      margin: 0 auto;
      padding: 24px 16px;
      text-align: center;

      flex-direction: column;
      align-items: center;
    }

    @media (min-width: 768px) {

      /* Tablets */
      .headline {
        font-size: 3.2rem;
        line-height: 1.5;
      }
    }

    @media (max-width: 600px) {
      .headline {
        font-size: 2rem !important;
        line-height: 1.4;
      }
    }

    @media (min-width: 601px) and (max-width: 767px) {
      .headline {
        font-size: 3.1rem;
        line-height: 1.6;
      }
    }

    @media (min-width: 1024px) {

      /* Pantallas grandes / desktop */
      .headline {
        font-size: 3.125rem;
        /* equivalente a ~50px */
        line-height: 1.6;
      }
    }

    @media (min-width: 768px) {

      /* Tablets */
      .copy-umbral {
        font-size: 22px;
        line-height: 1.7;
      }
    }

    @media (min-width: 1024px) {

      /* Pantallas grandes */
      .copy-umbral {
        font-size: 22px;
        line-height: 1.8;
      }
    }

    .copy-umbral p {
      font-weight: 100 !important;
    }

    #overlay-loader {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(10, 10, 10, 0.8);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 2147483647;
    }

    .overlay-content {
      text-align: center;
      color: #ffd700;
      font-size: 1.2rem;
    }

    @media (min-width: 1024px) {
      #vsl-section {
        margin-bottom: 4rem !important;
        padding-bottom: 3rem !important;
      }
    }

    .vsl-container1 {
      max-width: 98%;
      margin: 0 auto 80px auto;
      /* top right bottom left */
    }
  </style>

  <!-- Meta Pixel Code para revelacion-codex -->
  <script>
    !(function (f, b, e, v, n, t, s) {
      if (f.fbq) return;
      n = f.fbq = function () {
        n.callMethod
          ? n.callMethod.apply(n, arguments)
          : n.queue.push(arguments);
      };
      if (!f._fbq) f._fbq = n;
      n.push = n;
      n.loaded = !0;
      n.version = "2.0";
      n.queue = [];
      t = b.createElement(e);
      t.async = !0;
      t.src = v;
      s = b.getElementsByTagName(e)[0];
      s.parentNode.insertBefore(t, s);
    })(
      window,
      document,
      "script",
      "https://connect.facebook.net/en_US/fbevents.js"
    );

    fbq("init", "619760977647376");
    fbq("track", "PageView");
    fbq("trackCustom", "codex_revelation");
  </script>
  <noscript>
    <img height="1" width="1" style="display: none"
      src="https://www.facebook.com/tr?id=619760977647376&ev=PageView&noscript=1" />
  </noscript>
</head>

<body>
  <div id="overlay-loader" style="display: none">
    <div class="overlay-content">
      <div class="symbol"></div>
    </div>
  </div>

  <section id="vsl-section" class="codex-intro visible">
    <div class="headline">
      The Path of<br />
      <span class="subrayado">Transmutation</span><br />
      Opens Within
    </div>

    <div class="copy-umbral">
      <p>
        You have crossed a <span class="dorado">sacred threshold</span>‚Äîthe Great Work now begins.<br /><br />
        Stay open: what longs to emerge has already been inscribed<br />
        in the silent language of your soul.
      </p>
    </div>

    <div class="vsl-container1" style="
          max-width: 98%;
          margin-top: 3rem;
          margin-left: auto;
          margin-right: auto;
        ">
      <!-- Video Vturb Embed -->
      <div id="vid_683bb9e1cae10cbd5b78a083" style="position: relative; width: 100%; padding: 56.25% 0 0;"> <img
          id="thumb_683bb9e1cae10cbd5b78a083"
          src="https://images.converteai.net/40ccdce3-25cc-42b6-9238-2d5181ac9f41/players/683bb9e1cae10cbd5b78a083/thumbnail.jpg"
          style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; display: block;"
          alt="thumbnail">
        <div id="backdrop_683bb9e1cae10cbd5b78a083"
          style=" -webkit-backdrop-filter: blur(5px); backdrop-filter: blur(5px); position: absolute; top: 0; height: 100%; width: 100%; ">
        </div>
      </div>
      <script type="text/javascript"
        id="scr_683bb9e1cae10cbd5b78a083"> var s = document.createElement("script"); s.src = "https://scripts.converteai.net/40ccdce3-25cc-42b6-9238-2d5181ac9f41/players/683bb9e1cae10cbd5b78a083/player.js", s.async = !0, document.head.appendChild(s); </script>

      <div style="height: 20px"></div>
  </section>

  <script>
    let selectedCardIds = [];

    // Cartas de ejemplo (debes reemplazar im√°genes por las reales)
    const cartasData = {
      1: {
        nombre: "The Master of the Great Work",
        img: "https://media.atomicatpages.net/u/VKdhbutUBLg5pZCmDWr4fJf466f1/Pictures/EvcQpI2534195.jpeg",
      },
      2: {
        nombre: "The Guardian of Silence",
        img: "https://media.atomicatpages.net/u/VKdhbutUBLg5pZCmDWr4fJf466f1/Pictures/WXbiaf2534195.jpeg",
      },
      3: {
        nombre: "Genesis in the Retort",
        img: "https://media.atomicatpages.net/u/VKdhbutUBLg5pZCmDWr4fJf466f1/Pictures/CtWlzk2534195.jpeg",
      },
      4: {
        nombre: "The Harmony of the Spheres",
        img: "https://media.atomicatpages.net/u/VKdhbutUBLg5pZCmDWr4fJf466f1/Pictures/vnenhs2534195.jpeg",
      },
      5: {
        nombre: "The Council of the Arcanes",
        img: "https://media.atomicatpages.net/u/VKdhbutUBLg5pZCmDWr4fJf466f1/Pictures/hxFYoC2534195.jpeg",
      },
      6: {
        nombre: "The Inner Sun",
        img: "https://media.atomicatpages.net/u/VKdhbutUBLg5pZCmDWr4fJf466f1/Pictures/KeAluq2534195.jpeg",
      },
      7: {
        nombre: "The Compass of the Wise",
        img: "https://media.atomicatpages.net/u/VKdhbutUBLg5pZCmDWr4fJf466f1/Pictures/xrJXYj2534195.jpeg",
      },
      8: {
        nombre: "The Crypt of Rebirth",
        img: "https://media.atomicatpages.net/u/VKdhbutUBLg5pZCmDWr4fJf466f1/Pictures/mzXXMC2534195.jpeg",
      },
      9: {
        nombre: "The Balance of Opposites",
        img: "https://media.atomicatpages.net/u/VKdhbutUBLg5pZCmDWr4fJf466f1/Pictures/XdMAmo2534195.jpeg",
      },
      10: {
        nombre: "The Inner Labyrinth",
        img: "https://media.atomicatpages.net/u/VKdhbutUBLg5pZCmDWr4fJf466f1/Pictures/nCJjFD2534195.jpeg",
      },
      11: {
        nombre: "The Daughter of Water",
        img: "https://media.atomicatpages.net/u/VKdhbutUBLg5pZCmDWr4fJf466f1/Pictures/vmFlNG2534195.jpeg",
      },
      12: {
        nombre: "The Bath of the Red King",
        img: "https://media.atomicatpages.net/u/VKdhbutUBLg5pZCmDWr4fJf466f1/Pictures/mJtfJH2534195.jpeg",
      },
      13: {
        nombre: "The Robe of the Soul",
        img: "https://media.atomicatpages.net/u/VKdhbutUBLg5pZCmDWr4fJf466f1/Pictures/pdfLCl2534195.jpeg",
      },
      14: {
        nombre: "The Work Completed",
        img: "https://media.atomicatpages.net/u/VKdhbutUBLg5pZCmDWr4fJf466f1/Pictures/DLBPqw2534195.jpeg",
      },
      15: {
        nombre: "The Philosophical Tree",
        img: "https://media.atomicatpages.net/u/VKdhbutUBLg5pZCmDWr4fJf466f1/Pictures/itywin2534195.jpeg",
      },
      16: {
        nombre: "The Voice of Air",
        img: "https://media.atomicatpages.net/u/VKdhbutUBLg5pZCmDWr4fJf466f1/Pictures/kBdqjf2534195.jpeg",
      },
      17: {
        nombre: "The Cosmic Egg",
        img: "https://media.atomicatpages.net/u/VKdhbutUBLg5pZCmDWr4fJf466f1/Pictures/csLeJF2534195.jpeg",
      },
      18: {
        nombre: "The Sacred Dwelling",
        img: "https://media.atomicatpages.net/u/VKdhbutUBLg5pZCmDWr4fJf466f1/Pictures/srtYYL2534195.jpeg",
      },
      19: {
        nombre: "The Twin Sun",
        img: "https://media.atomicatpages.net/u/VKdhbutUBLg5pZCmDWr4fJf466f1/Pictures/uDFgMI2534195.jpeg",
      },
      20: {
        nombre: "Divine Geometry",
        img: "https://media.atomicatpages.net/u/VKdhbutUBLg5pZCmDWr4fJf466f1/Pictures/rthpYG2534195.jpeg",
      },
      21: {
        nombre: "The Stone of Chaos",
        img: "https://media.atomicatpages.net/u/VKdhbutUBLg5pZCmDWr4fJf466f1/Pictures/WNvcRP2534195.jpeg",
      },
      22: {
        nombre: "The Infinite Path",
        img: "https://media.atomicatpages.net/u/VKdhbutUBLg5pZCmDWr4fJf466f1/Pictures/EHzxmw2534195.jpeg",
      },
      23: {
        nombre: "The Guardian of the Threshold",
        img: "https://media.atomicatpages.net/u/VKdhbutUBLg5pZCmDWr4fJf466f1/Pictures/rflFDD2534195.jpeg",
      },
      24: {
        nombre: "The Fortress of Brotherhood",
        img: "https://media.atomicatpages.net/u/VKdhbutUBLg5pZCmDWr4fJf466f1/Pictures/KzjuNX2534195.jpeg",
      },
      25: {
        nombre: "The Living Circle",
        img: "https://media.atomicatpages.net/u/VKdhbutUBLg5pZCmDWr4fJf466f1/Pictures/XFsdYD2534195.jpeg",
      },
    };

    document.addEventListener("DOMContentLoaded", () => {
      const authKey = "G7!vP2#xQ9$zR4@tN1&kM3*eL6";

      // 1Ô∏è‚É£ Detectar id_sesion en la URL
      const urlParams = new URLSearchParams(window.location.search);
      const idSesionURL = urlParams.get("id_sesion");
      const idSesionLocal = localStorage.getItem("id_sesion_codex");

      if (idSesionURL) {
        console.log("üîó ID de sesi√≥n detectada en URL:", idSesionURL);
        localStorage.setItem("id_sesion_codex", idSesionURL);

        // Limpiar la URL sin recargar
        const cleanURL = window.location.origin + window.location.pathname;
        window.history.replaceState({}, document.title, cleanURL);
      }

      // 2Ô∏è‚É£ Restaurar cartas previas
      const stored = localStorage.getItem("selected_portal_codex");
      if (stored) {
        selectedCardIds = JSON.parse(stored);
        console.log("üÉè Cartas seleccionadas previamente:", selectedCardIds);
      }

      const idSesion = localStorage.getItem("id_sesion_codex");
      const yaGenerado = sessionStorage.getItem("codex_entregable_generado");

      console.log("üì¶ Ya generado:", yaGenerado);
      console.log("üîê Sesi√≥n activa:", idSesion);

      // 3Ô∏è‚É£ Generar entregable si a√∫n no ha sido generado
      if (idSesion && !yaGenerado) {
        fetch("https://api.omnipresence.me/api/generar-entregable-inicial", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ id_sesion: idSesion, authKey }),
        })
          .then((res) => res.json())
          .then((data) => {
            if (data.isValid === false) {
              console.warn("‚ö†Ô∏è Sesi√≥n inv√°lida:", data);
              return;
            }

            if (data.alreadyExists) {
              console.log("üì¶ Entregable ya exist√≠a previamente.");
            } else if (data.success) {
              console.log(
                "‚úÖ Entregable generado por primera vez:",
                data.pdfUrl
              );
            }

            // En ambos casos, marcamos como generado para esta sesi√≥n del navegador
            sessionStorage.setItem("codex_entregable_generado", "true");
          })
          .catch((err) => {
            console.error("‚ùå Error enviando interpretaci√≥n inicial:", err);
          });
      } else {
        console.log(
          "‚ÑπÔ∏è No se gener√≥ entregable: ya generado o sin id_sesion."
        );
      }
    });

    function mostrarCarruselCartasRestantes() {
      // Evitar que se duplique si ya fue ejecutado
      if (document.querySelector(".carousel-wrapper")) return;

      const wrapper = document.createElement("section");
      wrapper.className = "carousel-wrapper";
      wrapper.innerHTML = `
  <p class="copy-umbral">
    <span class="dorado">Two fragments</span> are waiting in your inner reflection‚Ä¶<br>
    Not in the outer world.<br>
    Their meaning lives in symbols your soul remembers deeply.
  </p>

    <div class="carousel-container" id="final-carousel"></div>

    <div class="button-container">
      <button class="btn-alquimico" id="confirmFinalSelection" style="display: none;">‚ú® Complete the cycle</button>
    </div>
  `;
      document.body.appendChild(wrapper);
      wrapper.scrollIntoView({ behavior: "smooth" });

      const restantes = Object.keys(cartasData)
        .map(Number)
        .filter((id) => !selectedCardIds.includes(id));
      const container = wrapper.querySelector("#final-carousel");
      const selectedFinals = [];

      // Agregar cartas al carrusel
      restantes.forEach((id) => {
        const carta = cartasData[id];
        const div = document.createElement("div");
        div.className = "card";
        div.dataset.id = id;
        div.innerHTML = `
      <img src="${carta.img}" alt="${carta.nombre}">
      <div class="card-title">${carta.nombre}</div>
    `;
        container.appendChild(div);
      });

      // Hacer scroll hasta el final con una peque√±a demora para asegurar carga visual
      setTimeout(() => {
        window.scrollTo({
          top: document.body.scrollHeight,
          behavior: "smooth",
        });
      }, 600); // puedes ajustar este tiempo si el scroll se adelanta

      // Escucha de selecci√≥n
      container.addEventListener("click", (e) => {
        const card = e.target.closest(".card");
        if (!card) return;

        const id = parseInt(card.dataset.id);
        const confirmBtn = document.getElementById("confirmFinalSelection");

        if (card.classList.contains("selected")) {
          card.classList.remove("selected");
          const idx = selectedFinals.indexOf(id);
          if (idx > -1) selectedFinals.splice(idx, 1);
        } else {
          if (selectedFinals.length < 2) {
            card.classList.add("selected");
            selectedFinals.push(id);
          }
        }

        const ready = selectedFinals.length === 2;
        if (ready) {
          //confirmBtn.disabled = false;
          //confirmBtn.classList.add("enabled");
          confirmBtn.style.display = "inline-block";
          confirmBtn.scrollIntoView({ behavior: "smooth" });
        } else {
          //confirmBtn.disabled = true;
          //confirmBtn.classList.remove("enabled");
          confirmBtn.style.display = "none";
        }
      });

      wrapper
        .querySelector("#confirmFinalSelection")
        .addEventListener("click", () => {
          const id_sesion = localStorage.getItem("id_sesion_codex");

          if (
            !id_sesion ||
            typeof id_sesion !== "string" ||
            id_sesion.length < 10
          ) {
            // ID inv√°lido o ausente
            window.location.href = "https://www.hermetic-codex.com";
            return;
          }

          // Mostrar loader desde el inicio
          document.getElementById("overlay-loader").style.display = "flex";

          // Verificar si la sesi√≥n existe en la base de datos
          fetch("https://api.omnipresence.me/api/obtener-datos-sesion", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              id_sesion,
              authKey: "G7!vP2#xQ9$zR4@tN1&kM3*eL6",
            }),
          })
            .then((res) => {
              if (res.status === 404 || res.status === 500) {
                throw new Error("Invalid or missing session");
              }
              return res.json();
            })
            .then((data) => {
              if (!data || !data.correo || !data.fragmentos) {
                throw new Error("Incomplete session data");
              }

              continuarConRegistroFinal(id_sesion);
            })
            .catch((err) => {
              console.warn("‚ùå Sesi√≥n inv√°lida:", err.message);
              localStorage.removeItem("id_sesion_codex");
              document.getElementById("overlay-loader").style.display =
                "none";
              window.location.href = "https://www.hermetic-codex.com";
            });
        });

      function continuarConRegistroFinal(id_sesion) {
        const primerasCinco = selectedCardIds.filter(
          (id) => !selectedFinals.includes(id)
        );
        const nuevasSeleccionadas = [...selectedFinals];
        const codexFinal = [
          ...new Set([...primerasCinco, ...nuevasSeleccionadas]),
        ].slice(0, 7);

        localStorage.setItem(
          "selected_revelation_codex",
          JSON.stringify(nuevasSeleccionadas)
        );

        const nuevosFragmentosData = nuevasSeleccionadas.map((id, index) => ({
          posicion: index + 6, // posiciones 6 y 7
          id_fragmento: id,
        }));

        fetch("https://api.omnipresence.me/api/agregar-fragmentos", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            id_sesion: id_sesion,
            fragmentos: nuevosFragmentosData,
            authKey: "G7!vP2#xQ9$zR4@tN1&kM3*eL6",
          }),
        })
          .then((response) => {
            if (!response.ok) {
              throw new Error("Final selection could not be saved.");
            }
            return response.json();
          })
          .then((data) => {
            console.log("‚úÖ Final fragments registered:", data);

            if (!localStorage.getItem("codex_revelacion_tracked")) {
              trackCodexRevelacionDesdeStorage();
              localStorage.setItem("codex_revelacion_tracked", "true");
            }

            document.getElementById("overlay-loader").style.display = "none";
            window.location.href = "close";
          })
          .catch((error) => {
            console.error("Error registering final fragments:", error);
            alert(
              "There was a problem saving your final selection. Please try again."
            );
            document.getElementById("overlay-loader").style.display = "none";
          });
      }
    }

    function trackCodexRevelacionDesdeStorage() {
      try {
        const cartasIniciales = JSON.parse(
          localStorage.getItem("selected_portal_codex") || "[]"
        );
        const cartasFinales = JSON.parse(
          localStorage.getItem("selected_revelation_codex") || "[]"
        );
        const intent = localStorage.getItem("intent_codex");

        const todasLasCartas = [
          ...new Set([...cartasIniciales, ...cartasFinales]),
        ];

        // S√≥lo guardar en localStorage como ya registrado (sin enviar a fbq)
        if (
          intent &&
          Array.isArray(todasLasCartas) &&
          todasLasCartas.length === 7 &&
          !localStorage.getItem("codex_revelacion_tracked")
        ) {
          localStorage.setItem("codex_revelacion_tracked", "true");
          console.log("[Codex Log] codex_path_chosen marked as completed:", {
            intent,
            cartas: todasLasCartas,
          });
        } else {
          console.warn(
            "[Codex Log] codex_path_chosen event not marked: incomplete data or already tracked."
          );
        }
      } catch (error) {
        console.error("[Codex Log Error] codex_path_chosen:", error);
      }
    }
  </script>
</body>

</html>
